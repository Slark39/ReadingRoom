const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/core-DpI5l3Y1.js","assets/index-Df_QNia4.js","assets/index-CKE0zMdo.css","assets/index.es-Bb1TNczd.js"])))=>i.map(i=>d[i]);
import{h as Z,j as $t,k as it,N as jt,_ as _t}from"./index-Df_QNia4.js";import{i as _e,f as Ht,p as St,O as Dt,k as Nt,a as qt,N as we,s as K,E as Tt,y as X,b as st,c as rt,o as _,d as Rt,e as de,g as fe,K as He}from"./index.es-Bb1TNczd.js";var ee={exports:{}},Se;function xt(){return Se||(Se=1,function(i,e){var t=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof Z<"u"&&Z,s=function(){function o(){this.fetch=!1,this.DOMException=t.DOMException}return o.prototype=t,new o}();(function(o){(function(n){var c=typeof o<"u"&&o||typeof self<"u"&&self||typeof Z<"u"&&Z||{},l={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function g(a){return a&&DataView.prototype.isPrototypeOf(a)}if(l.arrayBuffer)var d=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],y=ArrayBuffer.isView||function(a){return a&&d.indexOf(Object.prototype.toString.call(a))>-1};function m(a){if(typeof a!="string"&&(a=String(a)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(a)||a==="")throw new TypeError('Invalid character in header field name: "'+a+'"');return a.toLowerCase()}function v(a){return typeof a!="string"&&(a=String(a)),a}function I(a){var h={next:function(){var p=a.shift();return{done:p===void 0,value:p}}};return l.iterable&&(h[Symbol.iterator]=function(){return h}),h}function P(a){this.map={},a instanceof P?a.forEach(function(h,p){this.append(p,h)},this):Array.isArray(a)?a.forEach(function(h){if(h.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+h.length);this.append(h[0],h[1])},this):a&&Object.getOwnPropertyNames(a).forEach(function(h){this.append(h,a[h])},this)}P.prototype.append=function(a,h){a=m(a),h=v(h);var p=this.map[a];this.map[a]=p?p+", "+h:h},P.prototype.delete=function(a){delete this.map[m(a)]},P.prototype.get=function(a){return a=m(a),this.has(a)?this.map[a]:null},P.prototype.has=function(a){return this.map.hasOwnProperty(m(a))},P.prototype.set=function(a,h){this.map[m(a)]=v(h)},P.prototype.forEach=function(a,h){for(var p in this.map)this.map.hasOwnProperty(p)&&a.call(h,this.map[p],p,this)},P.prototype.keys=function(){var a=[];return this.forEach(function(h,p){a.push(p)}),I(a)},P.prototype.values=function(){var a=[];return this.forEach(function(h){a.push(h)}),I(a)},P.prototype.entries=function(){var a=[];return this.forEach(function(h,p){a.push([p,h])}),I(a)},l.iterable&&(P.prototype[Symbol.iterator]=P.prototype.entries);function le(a){if(!a._noBody){if(a.bodyUsed)return Promise.reject(new TypeError("Already read"));a.bodyUsed=!0}}function Oe(a){return new Promise(function(h,p){a.onload=function(){h(a.result)},a.onerror=function(){p(a.error)}})}function yt(a){var h=new FileReader,p=Oe(h);return h.readAsArrayBuffer(a),p}function bt(a){var h=new FileReader,p=Oe(h),w=/charset=([A-Za-z0-9_-]+)/.exec(a.type),b=w?w[1]:"utf-8";return h.readAsText(a,b),p}function Pt(a){for(var h=new Uint8Array(a),p=new Array(h.length),w=0;w<h.length;w++)p[w]=String.fromCharCode(h[w]);return p.join("")}function Ae(a){if(a.slice)return a.slice(0);var h=new Uint8Array(a.byteLength);return h.set(new Uint8Array(a)),h.buffer}function $e(){return this.bodyUsed=!1,this._initBody=function(a){this.bodyUsed=this.bodyUsed,this._bodyInit=a,a?typeof a=="string"?this._bodyText=a:l.blob&&Blob.prototype.isPrototypeOf(a)?this._bodyBlob=a:l.formData&&FormData.prototype.isPrototypeOf(a)?this._bodyFormData=a:l.searchParams&&URLSearchParams.prototype.isPrototypeOf(a)?this._bodyText=a.toString():l.arrayBuffer&&l.blob&&g(a)?(this._bodyArrayBuffer=Ae(a.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):l.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(a)||y(a))?this._bodyArrayBuffer=Ae(a):this._bodyText=a=Object.prototype.toString.call(a):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof a=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):l.searchParams&&URLSearchParams.prototype.isPrototypeOf(a)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},l.blob&&(this.blob=function(){var a=le(this);if(a)return a;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var a=le(this);return a||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(l.blob)return this.blob().then(yt);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var a=le(this);if(a)return a;if(this._bodyBlob)return bt(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(Pt(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},l.formData&&(this.formData=function(){return this.text().then(Et)}),this.json=function(){return this.text().then(JSON.parse)},this}var Ct=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function It(a){var h=a.toUpperCase();return Ct.indexOf(h)>-1?h:a}function S(a,h){if(!(this instanceof S))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');h=h||{};var p=h.body;if(a instanceof S){if(a.bodyUsed)throw new TypeError("Already read");this.url=a.url,this.credentials=a.credentials,h.headers||(this.headers=new P(a.headers)),this.method=a.method,this.mode=a.mode,this.signal=a.signal,!p&&a._bodyInit!=null&&(p=a._bodyInit,a.bodyUsed=!0)}else this.url=String(a);if(this.credentials=h.credentials||this.credentials||"same-origin",(h.headers||!this.headers)&&(this.headers=new P(h.headers)),this.method=It(h.method||this.method||"GET"),this.mode=h.mode||this.mode||null,this.signal=h.signal||this.signal||function(){if("AbortController"in c){var u=new AbortController;return u.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&p)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(p),(this.method==="GET"||this.method==="HEAD")&&(h.cache==="no-store"||h.cache==="no-cache")){var w=/([?&])_=[^&]*/;if(w.test(this.url))this.url=this.url.replace(w,"$1_="+new Date().getTime());else{var b=/\?/;this.url+=(b.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}S.prototype.clone=function(){return new S(this,{body:this._bodyInit})};function Et(a){var h=new FormData;return a.trim().split("&").forEach(function(p){if(p){var w=p.split("="),b=w.shift().replace(/\+/g," "),u=w.join("=").replace(/\+/g," ");h.append(decodeURIComponent(b),decodeURIComponent(u))}}),h}function Ot(a){var h=new P,p=a.replace(/\r?\n[\t ]+/g," ");return p.split("\r").map(function(w){return w.indexOf(`
`)===0?w.substr(1,w.length):w}).forEach(function(w){var b=w.split(":"),u=b.shift().trim();if(u){var Y=b.join(":").trim();try{h.append(u,Y)}catch(ue){console.warn("Response "+ue.message)}}}),h}$e.call(S.prototype);function j(a,h){if(!(this instanceof j))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(h||(h={}),this.type="default",this.status=h.status===void 0?200:h.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=h.statusText===void 0?"":""+h.statusText,this.headers=new P(h.headers),this.url=h.url||"",this._initBody(a)}$e.call(j.prototype),j.prototype.clone=function(){return new j(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new P(this.headers),url:this.url})},j.error=function(){var a=new j(null,{status:200,statusText:""});return a.ok=!1,a.status=0,a.type="error",a};var At=[301,302,303,307,308];j.redirect=function(a,h){if(At.indexOf(h)===-1)throw new RangeError("Invalid status code");return new j(null,{status:h,headers:{location:a}})},n.DOMException=c.DOMException;try{new n.DOMException}catch{n.DOMException=function(h,p){this.message=h,this.name=p;var w=Error(h);this.stack=w.stack},n.DOMException.prototype=Object.create(Error.prototype),n.DOMException.prototype.constructor=n.DOMException}function pe(a,h){return new Promise(function(p,w){var b=new S(a,h);if(b.signal&&b.signal.aborted)return w(new n.DOMException("Aborted","AbortError"));var u=new XMLHttpRequest;function Y(){u.abort()}u.onload=function(){var C={statusText:u.statusText,headers:Ot(u.getAllResponseHeaders()||"")};b.url.indexOf("file://")===0&&(u.status<200||u.status>599)?C.status=200:C.status=u.status,C.url="responseURL"in u?u.responseURL:C.headers.get("X-Request-URL");var D="response"in u?u.response:u.responseText;setTimeout(function(){p(new j(D,C))},0)},u.onerror=function(){setTimeout(function(){w(new TypeError("Network request failed"))},0)},u.ontimeout=function(){setTimeout(function(){w(new TypeError("Network request timed out"))},0)},u.onabort=function(){setTimeout(function(){w(new n.DOMException("Aborted","AbortError"))},0)};function ue(C){try{return C===""&&c.location.href?c.location.href:C}catch{return C}}if(u.open(b.method,ue(b.url),!0),b.credentials==="include"?u.withCredentials=!0:b.credentials==="omit"&&(u.withCredentials=!1),"responseType"in u&&(l.blob?u.responseType="blob":l.arrayBuffer&&(u.responseType="arraybuffer")),h&&typeof h.headers=="object"&&!(h.headers instanceof P||c.Headers&&h.headers instanceof c.Headers)){var je=[];Object.getOwnPropertyNames(h.headers).forEach(function(C){je.push(m(C)),u.setRequestHeader(C,v(h.headers[C]))}),b.headers.forEach(function(C,D){je.indexOf(D)===-1&&u.setRequestHeader(D,C)})}else b.headers.forEach(function(C,D){u.setRequestHeader(D,C)});b.signal&&(b.signal.addEventListener("abort",Y),u.onreadystatechange=function(){u.readyState===4&&b.signal.removeEventListener("abort",Y)}),u.send(typeof b._bodyInit>"u"?null:b._bodyInit)})}return pe.polyfill=!0,c.fetch||(c.fetch=pe,c.Headers=P,c.Request=S,c.Response=j),n.Headers=P,n.Request=S,n.Response=j,n.fetch=pe,Object.defineProperty(n,"__esModule",{value:!0}),n})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var r=t.fetch?t:s;e=r.fetch,e.default=r.fetch,e.fetch=r.fetch,e.Headers=r.Headers,e.Request=r.Request,e.Response=r.Response,i.exports=e}(ee,ee.exports)),ee.exports}var Mt=xt();const De=$t(Mt),Bt=i=>JSON.stringify(i,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),Ut=i=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=i.replace(e,'$1"$2n"$3');return JSON.parse(t,(s,r)=>typeof r=="string"&&r.match(/^\d+n$/)?BigInt(r.substring(0,r.length-1)):r)};function Ft(i){if(typeof i!="string")throw new Error(`Cannot safe json parse value of type ${typeof i}`);try{return Ut(i)}catch{return i}}function Ne(i){return typeof i=="string"?i:Bt(i)||""}var kt=Object.defineProperty,Lt=Object.defineProperties,zt=Object.getOwnPropertyDescriptors,qe=Object.getOwnPropertySymbols,Wt=Object.prototype.hasOwnProperty,Gt=Object.prototype.propertyIsEnumerable,Te=(i,e,t)=>e in i?kt(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Re=(i,e)=>{for(var t in e||(e={}))Wt.call(e,t)&&Te(i,t,e[t]);if(qe)for(var t of qe(e))Gt.call(e,t)&&Te(i,t,e[t]);return i},xe=(i,e)=>Lt(i,zt(e));const Jt={Accept:"application/json","Content-Type":"application/json"},Vt="POST",Me={headers:Jt,method:Vt},Be=10;let H=class{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new it.EventEmitter,this.isAvailable=!1,this.registering=!1,!_e(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const t=Ne(e),s=await(await De(this.url,xe(Re({},Me),{body:t}))).json();this.onPayload({data:s})}catch(t){this.onError(e.id,t)}}async register(e=this.url){if(!_e(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,r)=>{this.events.once("register_error",o=>{this.resetMaxListeners(),r(o)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return r(new Error("HTTP connection is missing or invalid"));s()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=Ne({id:1,jsonrpc:"2.0",method:"test",params:[]});await De(e,xe(Re({},Me),{body:t}))}this.onOpen()}catch(t){const s=this.parseError(t);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Ft(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),r=s.message||s.toString(),o=Ht(e,r);this.events.emit("payload",o)}parseError(e,t=this.url){return St(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Be&&this.events.setMaxListeners(Be)}};const Ue="error",Kt="wss://relay.walletconnect.org",Qt="wc",Xt="universal_provider",te=`${Qt}@2:${Xt}:`,nt="https://rpc.walletconnect.org/v1/",J="generic",Yt=`${nt}bundler`,$={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function Zt(){}function Ie(i){return i==null||typeof i!="object"&&typeof i!="function"}function Ee(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function ei(i){if(Ie(i))return i;if(Array.isArray(i)||Ee(i)||i instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&i instanceof SharedArrayBuffer)return i.slice(0);const e=Object.getPrototypeOf(i),t=e.constructor;if(i instanceof Date||i instanceof Map||i instanceof Set)return new t(i);if(i instanceof RegExp){const s=new t(i);return s.lastIndex=i.lastIndex,s}if(i instanceof DataView)return new t(i.buffer.slice(0));if(i instanceof Error){const s=new t(i.message);return s.stack=i.stack,s.name=i.name,s.cause=i.cause,s}if(typeof File<"u"&&i instanceof File)return new t([i],i.name,{type:i.type,lastModified:i.lastModified});if(typeof i=="object"){const s=Object.create(e);return Object.assign(s,i)}return i}function Fe(i){return typeof i=="object"&&i!==null}function at(i){return Object.getOwnPropertySymbols(i).filter(e=>Object.prototype.propertyIsEnumerable.call(i,e))}function ot(i){return i==null?i===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(i)}const ti="[object RegExp]",ct="[object String]",ht="[object Number]",lt="[object Boolean]",pt="[object Arguments]",ii="[object Symbol]",si="[object Date]",ri="[object Map]",ni="[object Set]",ai="[object Array]",oi="[object ArrayBuffer]",ci="[object Object]",hi="[object DataView]",li="[object Uint8Array]",pi="[object Uint8ClampedArray]",ui="[object Uint16Array]",di="[object Uint32Array]",fi="[object Int8Array]",mi="[object Int16Array]",vi="[object Int32Array]",gi="[object Float32Array]",wi="[object Float64Array]";function yi(i,e){return V(i,void 0,i,new Map,e)}function V(i,e,t,s=new Map,r=void 0){const o=r==null?void 0:r(i,e,t,s);if(o!=null)return o;if(Ie(i))return i;if(s.has(i))return s.get(i);if(Array.isArray(i)){const n=new Array(i.length);s.set(i,n);for(let c=0;c<i.length;c++)n[c]=V(i[c],c,t,s,r);return Object.hasOwn(i,"index")&&(n.index=i.index),Object.hasOwn(i,"input")&&(n.input=i.input),n}if(i instanceof Date)return new Date(i.getTime());if(i instanceof RegExp){const n=new RegExp(i.source,i.flags);return n.lastIndex=i.lastIndex,n}if(i instanceof Map){const n=new Map;s.set(i,n);for(const[c,l]of i)n.set(c,V(l,c,t,s,r));return n}if(i instanceof Set){const n=new Set;s.set(i,n);for(const c of i)n.add(V(c,void 0,t,s,r));return n}if(typeof Buffer<"u"&&Buffer.isBuffer(i))return i.subarray();if(Ee(i)){const n=new(Object.getPrototypeOf(i)).constructor(i.length);s.set(i,n);for(let c=0;c<i.length;c++)n[c]=V(i[c],c,t,s,r);return n}if(i instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&i instanceof SharedArrayBuffer)return i.slice(0);if(i instanceof DataView){const n=new DataView(i.buffer.slice(0),i.byteOffset,i.byteLength);return s.set(i,n),q(n,i,t,s,r),n}if(typeof File<"u"&&i instanceof File){const n=new File([i],i.name,{type:i.type});return s.set(i,n),q(n,i,t,s,r),n}if(i instanceof Blob){const n=new Blob([i],{type:i.type});return s.set(i,n),q(n,i,t,s,r),n}if(i instanceof Error){const n=new i.constructor;return s.set(i,n),n.message=i.message,n.name=i.name,n.stack=i.stack,n.cause=i.cause,q(n,i,t,s,r),n}if(typeof i=="object"&&bi(i)){const n=Object.create(Object.getPrototypeOf(i));return s.set(i,n),q(n,i,t,s,r),n}return i}function q(i,e,t=i,s,r){const o=[...Object.keys(e),...at(e)];for(let n=0;n<o.length;n++){const c=o[n],l=Object.getOwnPropertyDescriptor(i,c);(l==null||l.writable)&&(i[c]=V(e[c],c,t,s,r))}}function bi(i){switch(ot(i)){case pt:case ai:case oi:case hi:case lt:case si:case gi:case wi:case fi:case mi:case vi:case ri:case ht:case ci:case ti:case ni:case ct:case ii:case li:case pi:case ui:case di:return!0;default:return!1}}function Pi(i,e){return yi(i,(t,s,r,o)=>{if(typeof i=="object")switch(Object.prototype.toString.call(i)){case ht:case ct:case lt:{const n=new i.constructor(i==null?void 0:i.valueOf());return q(n,i),n}case pt:{const n={};return q(n,i),n.length=i.length,n[Symbol.iterator]=i[Symbol.iterator],n}default:return}})}function ke(i){return Pi(i)}function Le(i){return i!==null&&typeof i=="object"&&ot(i)==="[object Arguments]"}function Ci(i){return Ee(i)}function Ii(i){var t;if(typeof i!="object"||i==null)return!1;if(Object.getPrototypeOf(i)===null)return!0;if(Object.prototype.toString.call(i)!=="[object Object]"){const s=i[Symbol.toStringTag];return s==null||!((t=Object.getOwnPropertyDescriptor(i,Symbol.toStringTag))!=null&&t.writable)?!1:i.toString()===`[object ${s}]`}let e=i;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(i)===e}function Ei(i,...e){const t=e.slice(0,-1),s=e[e.length-1];let r=i;for(let o=0;o<t.length;o++){const n=t[o];r=ye(r,n,s,new Map)}return r}function ye(i,e,t,s){if(Ie(i)&&(i=Object(i)),e==null||typeof e!="object")return i;if(s.has(e))return ei(s.get(e));if(s.set(e,i),Array.isArray(e)){e=e.slice();for(let o=0;o<e.length;o++)e[o]=e[o]??void 0}const r=[...Object.keys(e),...at(e)];for(let o=0;o<r.length;o++){const n=r[o];let c=e[n],l=i[n];if(Le(c)&&(c={...c}),Le(l)&&(l={...l}),typeof Buffer<"u"&&Buffer.isBuffer(c)&&(c=ke(c)),Array.isArray(c))if(typeof l=="object"&&l!=null){const d=[],y=Reflect.ownKeys(l);for(let m=0;m<y.length;m++){const v=y[m];d[v]=l[v]}l=d}else l=[];const g=t(l,c,n,i,e,s);g!=null?i[n]=g:Array.isArray(c)||Fe(l)&&Fe(c)?i[n]=ye(l,c,t,s):l==null&&Ii(c)?i[n]=ye({},c,t,s):l==null&&Ci(c)?i[n]=ke(c):(l===void 0||c!==void 0)&&(i[n]=c)}return i}function Oi(i,...e){return Ei(i,...e,Zt)}var Ai=Object.defineProperty,$i=Object.defineProperties,ji=Object.getOwnPropertyDescriptors,ze=Object.getOwnPropertySymbols,_i=Object.prototype.hasOwnProperty,Hi=Object.prototype.propertyIsEnumerable,We=(i,e,t)=>e in i?Ai(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,ie=(i,e)=>{for(var t in e||(e={}))_i.call(e,t)&&We(i,t,e[t]);if(ze)for(var t of ze(e))Hi.call(e,t)&&We(i,t,e[t]);return i},Si=(i,e)=>$i(i,ji(e));function O(i,e,t){var s;const r=rt(i);return((s=e.rpcMap)==null?void 0:s[r.reference])||`${nt}?chainId=${r.namespace}:${r.reference}&projectId=${t}`}function T(i){return i.includes(":")?i.split(":")[1]:i}function ut(i){return i.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function Di(i,e){const t=Object.keys(e.namespaces).filter(r=>r.includes(i));if(!t.length)return[];const s=[];return t.forEach(r=>{const o=e.namespaces[r].accounts;s.push(...o)}),s}function se(i={},e={}){const t=Ge(i),s=Ge(e);return Oi(t,s)}function Ge(i){var e,t,s,r,o;const n={};if(!de(i))return n;for(const[c,l]of Object.entries(i)){const g=st(c)?[c]:l.chains,d=l.methods||[],y=l.events||[],m=l.rpcMap||{},v=X(c);n[v]=Si(ie(ie({},n[v]),l),{chains:fe(g,(e=n[v])==null?void 0:e.chains),methods:fe(d,(t=n[v])==null?void 0:t.methods),events:fe(y,(s=n[v])==null?void 0:s.events)}),(de(m)||de(((r=n[v])==null?void 0:r.rpcMap)||{}))&&(n[v].rpcMap=ie(ie({},m),(o=n[v])==null?void 0:o.rpcMap))}return n}function Je(i){return i.includes(":")?i.split(":")[2]:i}function Ve(i){const e={};for(const[t,s]of Object.entries(i)){const r=s.methods||[],o=s.events||[],n=s.accounts||[],c=st(t)?[t]:s.chains?s.chains:ut(s.accounts);e[t]={chains:c,methods:r,events:o,accounts:n}}return e}function me(i){return typeof i=="number"?i:i.includes("0x")?parseInt(i,16):(i=i.includes(":")?i.split(":")[1]:i,isNaN(Number(i))?i:Number(i))}const dt={},f=i=>dt[i],ve=(i,e)=>{dt[i]=e};var Ni=Object.defineProperty,qi=(i,e,t)=>e in i?Ni(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,R=(i,e,t)=>qi(i,typeof e!="symbol"?e+"":e,t);class Ti{constructor(e){R(this,"name","polkadot"),R(this,"client"),R(this,"httpProviders"),R(this,"events"),R(this,"namespace"),R(this,"chainId"),this.namespace=e.namespace,this.events=f("events"),this.client=f("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit($.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const r=T(t);e[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||O(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new _(new H(s,f("disableProviderPing")))}}var Ri=Object.defineProperty,xi=Object.defineProperties,Mi=Object.getOwnPropertyDescriptors,Ke=Object.getOwnPropertySymbols,Bi=Object.prototype.hasOwnProperty,Ui=Object.prototype.propertyIsEnumerable,be=(i,e,t)=>e in i?Ri(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Qe=(i,e)=>{for(var t in e||(e={}))Bi.call(e,t)&&be(i,t,e[t]);if(Ke)for(var t of Ke(e))Ui.call(e,t)&&be(i,t,e[t]);return i},Xe=(i,e)=>xi(i,Mi(e)),x=(i,e,t)=>be(i,typeof e!="symbol"?e+"":e,t);class Fi{constructor(e){x(this,"name","eip155"),x(this,"client"),x(this,"chainId"),x(this,"namespace"),x(this,"httpProviders"),x(this,"events"),this.namespace=e.namespace,this.events=f("events"),this.client=f("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit($.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const s=t||O(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new _(new H(s,f("disableProviderPing")))}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const r=parseInt(T(t));e[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,s;let r=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";r=r.startsWith("0x")?r:`0x${r}`;const o=parseInt(r,16);if(this.isChainApproved(o))this.setDefaultChain(`${o}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:r}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${o}`);else throw new Error(`Failed to switch to chain 'eip155:${o}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,s,r,o,n;const c=(s=(t=e.request)==null?void 0:t.params)==null?void 0:s[0],l=((o=(r=e.request)==null?void 0:r.params)==null?void 0:o[1])||[],g=`${c}${l.join(",")}`;if(!c)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const d=this.client.session.get(e.topic),y=((n=d==null?void 0:d.sessionProperties)==null?void 0:n.capabilities)||{};if(y!=null&&y[g])return y==null?void 0:y[g];const m=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:Xe(Qe({},d.sessionProperties||{}),{capabilities:Xe(Qe({},y||{}),{[g]:m})})})}catch(v){console.warn("Failed to update session with capabilities",v)}return m}async getCallStatus(e){var t,s;const r=this.client.session.get(e.topic),o=(t=r.sessionProperties)==null?void 0:t.bundler_name;if(o){const c=this.getBundlerUrl(e.chainId,o);try{return await this.getUserOperationReceipt(c,e)}catch(l){console.warn("Failed to fetch call status from bundler",l,c)}}const n=(s=r.sessionProperties)==null?void 0:s.bundler_url;if(n)try{return await this.getUserOperationReceipt(n,e)}catch(c){console.warn("Failed to fetch call status from custom bundler",c,n)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,t){var s;const r=new URL(e),o=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Rt("eth_getUserOperationReceipt",[(s=t.request.params)==null?void 0:s[0]]))});if(!o.ok)throw new Error(`Failed to fetch user operation receipt - ${o.status}`);return await o.json()}getBundlerUrl(e,t){return`${Yt}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${t}`}}var ki=Object.defineProperty,Li=(i,e,t)=>e in i?ki(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,M=(i,e,t)=>Li(i,typeof e!="symbol"?e+"":e,t);class zi{constructor(e){M(this,"name","solana"),M(this,"client"),M(this,"httpProviders"),M(this,"events"),M(this,"namespace"),M(this,"chainId"),this.namespace=e.namespace,this.events=f("events"),this.client=f("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit($.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const r=T(t);e[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||O(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new _(new H(s,f("disableProviderPing")))}}var Wi=Object.defineProperty,Gi=(i,e,t)=>e in i?Wi(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,B=(i,e,t)=>Gi(i,typeof e!="symbol"?e+"":e,t);class Ji{constructor(e){B(this,"name","cosmos"),B(this,"client"),B(this,"httpProviders"),B(this,"events"),B(this,"namespace"),B(this,"chainId"),this.namespace=e.namespace,this.events=f("events"),this.client=f("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit($.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const r=T(t);e[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||O(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new _(new H(s,f("disableProviderPing")))}}var Vi=Object.defineProperty,Ki=(i,e,t)=>e in i?Vi(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,U=(i,e,t)=>Ki(i,typeof e!="symbol"?e+"":e,t);class Qi{constructor(e){U(this,"name","algorand"),U(this,"client"),U(this,"httpProviders"),U(this,"events"),U(this,"namespace"),U(this,"chainId"),this.namespace=e.namespace,this.events=f("events"),this.client=f("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||O(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit($.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||O(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new _(new H(s,f("disableProviderPing")))}}var Xi=Object.defineProperty,Yi=(i,e,t)=>e in i?Xi(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,F=(i,e,t)=>Yi(i,typeof e!="symbol"?e+"":e,t);class Zi{constructor(e){F(this,"name","cip34"),F(this,"client"),F(this,"httpProviders"),F(this,"events"),F(this,"namespace"),F(this,"chainId"),this.namespace=e.namespace,this.events=f("events"),this.client=f("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit($.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const s=this.getCardanoRPCUrl(t),r=T(t);e[r]=this.createHttpProvider(r,s)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||this.getCardanoRPCUrl(e);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new _(new H(s,f("disableProviderPing")))}}var es=Object.defineProperty,ts=(i,e,t)=>e in i?es(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,k=(i,e,t)=>ts(i,typeof e!="symbol"?e+"":e,t);class is{constructor(e){k(this,"name","elrond"),k(this,"client"),k(this,"httpProviders"),k(this,"events"),k(this,"namespace"),k(this,"chainId"),this.namespace=e.namespace,this.events=f("events"),this.client=f("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit($.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const r=T(t);e[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||O(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new _(new H(s,f("disableProviderPing")))}}var ss=Object.defineProperty,rs=(i,e,t)=>e in i?ss(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,L=(i,e,t)=>rs(i,typeof e!="symbol"?e+"":e,t);class ns{constructor(e){L(this,"name","multiversx"),L(this,"client"),L(this,"httpProviders"),L(this,"events"),L(this,"namespace"),L(this,"chainId"),this.namespace=e.namespace,this.events=f("events"),this.client=f("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit($.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const r=T(t);e[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||O(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new _(new H(s,f("disableProviderPing")))}}var as=Object.defineProperty,os=(i,e,t)=>e in i?as(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,z=(i,e,t)=>os(i,typeof e!="symbol"?e+"":e,t);class cs{constructor(e){z(this,"name","near"),z(this,"client"),z(this,"httpProviders"),z(this,"events"),z(this,"namespace"),z(this,"chainId"),this.namespace=e.namespace,this.events=f("events"),this.client=f("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||O(`${this.name}:${e}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit($.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||O(e,this.namespace);return typeof s>"u"?void 0:new _(new H(s,f("disableProviderPing")))}}var hs=Object.defineProperty,ls=(i,e,t)=>e in i?hs(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,W=(i,e,t)=>ls(i,typeof e!="symbol"?e+"":e,t);class ps{constructor(e){W(this,"name","tezos"),W(this,"client"),W(this,"httpProviders"),W(this,"events"),W(this,"namespace"),W(this,"chainId"),this.namespace=e.namespace,this.events=f("events"),this.client=f("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||O(`${this.name}:${e}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit($.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||O(e,this.namespace);return typeof s>"u"?void 0:new _(new H(s))}}var us=Object.defineProperty,ds=(i,e,t)=>e in i?us(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,G=(i,e,t)=>ds(i,typeof e!="symbol"?e+"":e,t);class fs{constructor(e){G(this,"name",J),G(this,"client"),G(this,"httpProviders"),G(this,"events"),G(this,"namespace"),G(this,"chainId"),this.namespace=e.namespace,this.events=f("events"),this.client=f("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit($.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){var e,t;const s={};return(t=(e=this.namespace)==null?void 0:e.accounts)==null||t.forEach(r=>{const o=rt(r);s[`${o.namespace}:${o.reference}`]=this.createHttpProvider(r)}),s}getHttpProvider(e){const t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||O(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new _(new H(s,f("disableProviderPing")))}}var ms=Object.defineProperty,vs=Object.defineProperties,gs=Object.getOwnPropertyDescriptors,Ye=Object.getOwnPropertySymbols,ws=Object.prototype.hasOwnProperty,ys=Object.prototype.propertyIsEnumerable,Pe=(i,e,t)=>e in i?ms(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,re=(i,e)=>{for(var t in e||(e={}))ws.call(e,t)&&Pe(i,t,e[t]);if(Ye)for(var t of Ye(e))ys.call(e,t)&&Pe(i,t,e[t]);return i},ge=(i,e)=>vs(i,gs(e)),A=(i,e,t)=>Pe(i,typeof e!="symbol"?e+"":e,t);let bs=class ft{constructor(e){A(this,"client"),A(this,"namespaces"),A(this,"optionalNamespaces"),A(this,"sessionProperties"),A(this,"scopedProperties"),A(this,"events",new jt),A(this,"rpcProviders",{}),A(this,"session"),A(this,"providerOpts"),A(this,"logger"),A(this,"uri"),A(this,"disableProviderPing",!1),this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Dt(Nt({level:(e==null?void 0:e.logger)||Ue})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new ft(e);return await t.initialize(),t}async request(e,t,s){const[r,o]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(r).request({request:re({},e),chainId:`${r}:${o}`,topic:this.session.topic,expiry:s})}sendAsync(e,t,s,r){const o=new Date().getTime();this.request(e,s,r).then(n=>t(null,qt(o,n))).catch(n=>t(n,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:we("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:s,response:r}=await this.client.authenticate(e,t);s&&(this.uri=s,this.events.emit("display_uri",s));const o=await r();if(this.session=o.session,this.session){const n=Ve(this.session.namespaces);this.namespaces=se(this.namespaces,n),await this.persist("namespaces",this.namespaces),this.onConnect()}return o}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){const{uri:t,approval:s}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});t&&(this.uri=t,this.events.emit("display_uri",t));const r=await s();this.session=r;const o=Ve(r.namespaces);return this.namespaces=se(this.namespaces,o),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[s,r]=this.validateChain(e),o=this.getProvider(s);o.name===J?o.setDefaultChain(`${s}:${r}`,t):o.setDefaultChain(r,t)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(K(t)){for(const s of t)e.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,t;if(this.client=this.providerOpts.client||await Tt.init({core:this.providerOpts.core,logger:this.providerOpts.logger||Ue,relayUrl:this.providerOpts.relayUrl||Kt,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(s){throw this.logger.error("Failed to get session",s),new Error(`The provided session: ${(t=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:t.topic} doesn't exist in the Sign client`)}else{const s=this.client.session.getAll();this.session=s[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>X(t)))];ve("client",this.client),ve("events",this.events),ve("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const s=Di(t,this.session),r=ut(s),o=se(this.namespaces,this.optionalNamespaces),n=ge(re({},o[t]),{accounts:s,chains:r});switch(t){case"eip155":this.rpcProviders[t]=new Fi({namespace:n});break;case"algorand":this.rpcProviders[t]=new Qi({namespace:n});break;case"solana":this.rpcProviders[t]=new zi({namespace:n});break;case"cosmos":this.rpcProviders[t]=new Ji({namespace:n});break;case"polkadot":this.rpcProviders[t]=new Ti({namespace:n});break;case"cip34":this.rpcProviders[t]=new Zi({namespace:n});break;case"elrond":this.rpcProviders[t]=new is({namespace:n});break;case"multiversx":this.rpcProviders[t]=new ns({namespace:n});break;case"near":this.rpcProviders[t]=new cs({namespace:n});break;case"tezos":this.rpcProviders[t]=new ps({namespace:n});break;default:this.rpcProviders[J]?this.rpcProviders[J].updateNamespace(n):this.rpcProviders[J]=new fs({namespace:n})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var t;const{topic:s}=e;s===((t=this.session)==null?void 0:t.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var t;const{params:s,topic:r}=e;if(r!==((t=this.session)==null?void 0:t.topic))return;const{event:o}=s;if(o.name==="accountsChanged"){const n=o.data;n&&K(n)&&this.events.emit("accountsChanged",n.map(Je))}else if(o.name==="chainChanged"){const n=s.chainId,c=s.event.data,l=X(n),g=me(n)!==me(c)?`${l}:${me(c)}`:n;this.onChainChanged(g)}else this.events.emit(o.name,o.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var s,r;if(e!==((s=this.session)==null?void 0:s.topic))return;const{namespaces:o}=t,n=(r=this.client)==null?void 0:r.session.get(e);this.session=ge(re({},n),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{var t;e.topic===((t=this.session)==null?void 0:t.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",ge(re({},we("USER_DISCONNECTED")),{data:e.topic})))}),this.on($.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[J]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t={},optionalNamespaces:s={},sessionProperties:r,scopedProperties:o}=e;this.optionalNamespaces=se(t,s),this.sessionProperties=r,this.scopedProperties=o}validateChain(e){const[t,s]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,s];if(t&&!Object.keys(this.namespaces||{}).map(n=>X(n)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&s)return[t,s];const r=X(Object.keys(this.namespaces)[0]),o=this.rpcProviders[r].getDefaultChain();return[r,o]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e,t=!1){if(!this.namespaces)return;const[s,r]=this.validateChain(e);if(!r)return;this.updateNamespaceChain(s,r),this.events.emit("chainChanged",r);const o=this.getProvider(s).getDefaultChain();t||this.getProvider(s).setDefaultChain(r),this.emitAccountsChangedOnChainChange({namespace:s,previousChainId:o,newChainId:e}),await this.persist("namespaces",this.namespaces)}emitAccountsChangedOnChainChange({namespace:e,previousChainId:t,newChainId:s}){var r,o;try{if(t===s)return;const n=(o=(r=this.session)==null?void 0:r.namespaces[e])==null?void 0:o.accounts;if(!n)return;const c=n.filter(l=>l.includes(`${s}:`)).map(Je);if(!K(c))return;this.events.emit("accountsChanged",c)}catch(n){this.logger.warn("Failed to emit accountsChanged on chain change",n)}}updateNamespaceChain(e,t){if(!this.namespaces)return;const s=this.namespaces[e]?e:`${e}:${t}`,r={chains:[],methods:[],events:[],defaultChain:t};this.namespaces[s]?this.namespaces[s]&&(this.namespaces[s].defaultChain=t):this.namespaces[s]=r}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,t){var s;const r=((s=this.session)==null?void 0:s.topic)||"";await this.client.core.storage.setItem(`${te}/${e}${r}`,t)}async getFromStore(e){var t;const s=((t=this.session)==null?void 0:t.topic)||"";return await this.client.core.storage.getItem(`${te}/${e}${s}`)}async deleteFromStore(e){var t;const s=((t=this.session)==null?void 0:t.topic)||"";await this.client.core.storage.removeItem(`${te}/${e}${s}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;const t=await this.client.core.storage.getKeys();for(const s of t)s.startsWith(te)&&await this.client.core.storage.removeItem(s)}catch(t){this.logger.warn("Failed to cleanup storage",t)}}};const Ps=bs,Cs="wc",Is="ethereum_provider",Es=`${Cs}@2:${Is}:`,Os="https://rpc.walletconnect.org/v1/",ae=["eth_sendTransaction","personal_sign"],mt=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_sendCalls","wallet_getCapabilities","wallet_getCallsStatus","wallet_showCallsStatus"],oe=["chainChanged","accountsChanged"],vt=["chainChanged","accountsChanged","message","disconnect","connect"],As=async()=>{const{createAppKit:i}=await _t(()=>import("./core-DpI5l3Y1.js").then(e=>e.X),__vite__mapDeps([0,1,2,3]));return i};var $s=Object.defineProperty,js=Object.defineProperties,_s=Object.getOwnPropertyDescriptors,Ze=Object.getOwnPropertySymbols,Hs=Object.prototype.hasOwnProperty,Ss=Object.prototype.propertyIsEnumerable,Ce=(i,e,t)=>e in i?$s(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,N=(i,e)=>{for(var t in e||(e={}))Hs.call(e,t)&&Ce(i,t,e[t]);if(Ze)for(var t of Ze(e))Ss.call(e,t)&&Ce(i,t,e[t]);return i},Q=(i,e)=>js(i,_s(e)),E=(i,e,t)=>Ce(i,typeof e!="symbol"?e+"":e,t);function ce(i){return Number(i[0].split(":")[1])}function ne(i){return`0x${i.toString(16)}`}function Ds(i){const{chains:e,optionalChains:t,methods:s,optionalMethods:r,events:o,optionalEvents:n,rpcMap:c}=i;if(!K(e))throw new Error("Invalid chains");const l={chains:e,methods:s||ae,events:o||oe,rpcMap:N({},e.length?{[ce(e)]:c[ce(e)]}:{})},g=o==null?void 0:o.filter(v=>!oe.includes(v)),d=s==null?void 0:s.filter(v=>!ae.includes(v));if(!t&&!n&&!r&&!(g!=null&&g.length)&&!(d!=null&&d.length))return{required:e.length?l:void 0};const y=(g==null?void 0:g.length)&&(d==null?void 0:d.length)||!t,m={chains:[...new Set(y?l.chains.concat(t||[]):t)],methods:[...new Set(l.methods.concat(r!=null&&r.length?r:mt))],events:[...new Set(l.events.concat(n!=null&&n.length?n:vt))],rpcMap:c};return{required:e.length?l:void 0,optional:t.length?m:void 0}}class he{constructor(){E(this,"events",new it.EventEmitter),E(this,"namespace","eip155"),E(this,"accounts",[]),E(this,"signer"),E(this,"chainId",1),E(this,"modal"),E(this,"rpc"),E(this,"STORAGE_KEY",Es),E(this,"on",(e,t)=>(this.events.on(e,t),this)),E(this,"once",(e,t)=>(this.events.once(e,t),this)),E(this,"removeListener",(e,t)=>(this.events.removeListener(e,t),this)),E(this,"off",(e,t)=>(this.events.off(e,t),this)),E(this,"parseAccount",e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e),this.signer={},this.rpc={}}static async init(e){const t=new he;return await t.initialize(e),t}async request(e,t){return await this.signer.request(e,this.formatChainId(this.chainId),t)}sendAsync(e,t,s){this.signer.sendAsync(e,t,this.formatChainId(this.chainId),s)}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){var t;if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:s,optional:r}=Ds(this.rpc);try{const o=await new Promise(async(c,l)=>{var g,d;this.rpc.showQrModal&&((g=this.modal)==null||g.open(),(d=this.modal)==null||d.subscribeState(m=>{!m.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),l(new Error("Connection request reset. Please try again.")))}));const y=e!=null&&e.scopedProperties?{[this.namespace]:e.scopedProperties}:void 0;await this.signer.connect(Q(N({namespaces:N({},s&&{[this.namespace]:s})},r&&{optionalNamespaces:{[this.namespace]:r}}),{pairingTopic:e==null?void 0:e.pairingTopic,scopedProperties:y})).then(m=>{c(m)}).catch(m=>{var v;(v=this.modal)==null||v.showErrorMessage("Unable to connect"),l(new Error(m.message))})});if(!o)return;const n=He(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:n),this.setAccounts(n),this.events.emit("connect",{chainId:ne(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{(t=this.modal)==null||t.close()}}async authenticate(e,t){var s;if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts({chains:e==null?void 0:e.chains});try{const r=await new Promise(async(n,c)=>{var l,g;this.rpc.showQrModal&&((l=this.modal)==null||l.open(),(g=this.modal)==null||g.subscribeState(d=>{!d.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),c(new Error("Connection request reset. Please try again.")))})),await this.signer.authenticate(Q(N({},e),{chains:this.rpc.chains}),t).then(d=>{n(d)}).catch(d=>{var y;(y=this.modal)==null||y.showErrorMessage("Unable to connect"),c(new Error(d.message))})}),o=r.session;if(o){const n=He(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:n),this.setAccounts(n),this.events.emit("connect",{chainId:ne(this.chainId)})}return r}catch(r){throw this.signer.logger.error(r),r}finally{(s=this.modal)==null||s.close()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:t}=e,{event:s}=t;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",e)}),this.signer.on("accountsChanged",e=>{this.accounts=this.parseAccounts(e),this.events.emit("accountsChanged",this.accounts)}),this.signer.on("chainChanged",e=>{const t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",ne(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",Q(N({},we("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const t=e.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",ne(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){const[t,s,r]=e.split(":");return{chainId:`${t}:${s}`,address:r}}setAccounts(e){this.accounts=e.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,s;const r=(t=e==null?void 0:e.chains)!=null?t:[],o=(s=e==null?void 0:e.optionalChains)!=null?s:[],n=r.concat(o);if(!n.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const c=r.length?(e==null?void 0:e.methods)||ae:[],l=r.length?(e==null?void 0:e.events)||oe:[],g=(e==null?void 0:e.optionalMethods)||[],d=(e==null?void 0:e.optionalEvents)||[],y=(e==null?void 0:e.rpcMap)||this.buildRpcMap(n,e.projectId),m=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:r==null?void 0:r.map(v=>this.formatChainId(v)),optionalChains:o.map(v=>this.formatChainId(v)),methods:c,events:l,optionalMethods:g,optionalEvents:d,rpcMap:y,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:m,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){const s={};return e.forEach(r=>{s[r]=this.getRpcUrl(r,t)}),s}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?ce(this.rpc.chains):ce(this.rpc.optionalChains),this.signer=await Ps.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storage:e.storage,storageOptions:e.storageOptions,customStoragePrefix:e.customStoragePrefix,telemetryEnabled:e.telemetryEnabled,logger:e.logger}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const s=await As(),{convertWCMToAppKitOptions:r}=await Promise.resolve().then(function(){return Ls}),o=r(Q(N({},this.rpc.qrModalOptions),{chains:[...new Set([...this.rpc.chains,...this.rpc.optionalChains])],metadata:this.rpc.metadata,projectId:this.rpc.projectId}));if(!o.networks.length)throw new Error("No networks found for WalletConnect");t=s(Q(N({},o),{universalProvider:this.signer,manualWCControl:!0}))}catch(s){throw console.warn(s),new Error("To use QR modal, please install @reown/appkit package")}if(t)try{this.modal=t}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:t,optionalChains:s,rpcMap:r}=e;t&&K(t)&&(this.rpc.chains=t.map(o=>this.formatChainId(o)),t.forEach(o=>{this.rpc.rpcMap[o]=(r==null?void 0:r[o])||this.getRpcUrl(o)})),s&&K(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(o=>this.formatChainId(o)),s.forEach(o=>{this.rpc.rpcMap[o]=(r==null?void 0:r[o])||this.getRpcUrl(o)}))}getRpcUrl(e,t){var s;return((s=this.rpc.rpcMap)==null?void 0:s[e])||`${Os}?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(this.session)try{const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}catch(e){this.signer.logger.error("Failed to load persisted session, clearing state..."),this.signer.logger.error(e),await this.disconnect().catch(t=>this.signer.logger.warn(t))}}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(t=>this.parseAccount(t))}}const Ns=he;var qs=Object.defineProperty,Ts=Object.defineProperties,Rs=Object.getOwnPropertyDescriptors,et=Object.getOwnPropertySymbols,xs=Object.prototype.hasOwnProperty,Ms=Object.prototype.propertyIsEnumerable,tt=(i,e,t)=>e in i?qs(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,gt=(i,e)=>{for(var t in e||(e={}))xs.call(e,t)&&tt(i,t,e[t]);if(et)for(var t of et(e))Ms.call(e,t)&&tt(i,t,e[t]);return i},Bs=(i,e)=>Ts(i,Rs(e));function Us(i){if(i)return{"--w3m-font-family":i["--wcm-font-family"],"--w3m-accent":i["--wcm-accent-color"],"--w3m-color-mix":i["--wcm-background-color"],"--w3m-z-index":i["--wcm-z-index"]?Number(i["--wcm-z-index"]):void 0,"--w3m-qr-color":i["--wcm-accent-color"],"--w3m-font-size-master":i["--wcm-text-medium-regular-size"],"--w3m-border-radius-master":i["--wcm-container-border-radius"],"--w3m-color-mix-strength":0}}const Fs=i=>{const[e,t]=i.split(":");return wt({id:t,caipNetworkId:i,chainNamespace:e,name:"",nativeCurrency:{name:"",symbol:"",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}})};function ks(i){var e,t,s,r,o,n,c;const l=(e=i.chains)==null?void 0:e.map(Fs).filter(Boolean);if(l.length===0)throw new Error("At least one chain must be specified");const g=l.find(y=>{var m;return y.id===((m=i.defaultChain)==null?void 0:m.id)}),d={projectId:i.projectId,networks:l,themeMode:i.themeMode,themeVariables:Us(i.themeVariables),chainImages:i.chainImages,connectorImages:i.walletImages,defaultNetwork:g,metadata:Bs(gt({},i.metadata),{name:((t=i.metadata)==null?void 0:t.name)||"WalletConnect",description:((s=i.metadata)==null?void 0:s.description)||"Connect to WalletConnect-compatible wallets",url:((r=i.metadata)==null?void 0:r.url)||"https://walletconnect.org",icons:((o=i.metadata)==null?void 0:o.icons)||["https://walletconnect.org/walletconnect-logo.png"]}),showWallets:!0,featuredWalletIds:i.explorerRecommendedWalletIds==="NONE"?[]:Array.isArray(i.explorerRecommendedWalletIds)?i.explorerRecommendedWalletIds:[],excludeWalletIds:i.explorerExcludedWalletIds==="ALL"?[]:Array.isArray(i.explorerExcludedWalletIds)?i.explorerExcludedWalletIds:[],enableEIP6963:!1,enableInjected:!1,enableCoinbase:!0,enableWalletConnect:!0,features:{email:!1,socials:!1}};if((n=i.mobileWallets)!=null&&n.length||(c=i.desktopWallets)!=null&&c.length){const y=[...(i.mobileWallets||[]).map(I=>({id:I.id,name:I.name,links:I.links})),...(i.desktopWallets||[]).map(I=>({id:I.id,name:I.name,links:{native:I.links.native,universal:I.links.universal}}))],m=[...d.featuredWalletIds||[],...d.excludeWalletIds||[]],v=y.filter(I=>!m.includes(I.id));v.length&&(d.customWallets=v)}return d}function wt(i){return gt({formatters:void 0,fees:void 0,serializers:void 0},i)}var Ls=Object.freeze({__proto__:null,convertWCMToAppKitOptions:ks,defineChain:wt});const Js=Object.freeze(Object.defineProperty({__proto__:null,EthereumProvider:Ns,OPTIONAL_EVENTS:vt,OPTIONAL_METHODS:mt,REQUIRED_EVENTS:oe,REQUIRED_METHODS:ae,default:he},Symbol.toStringTag,{value:"Module"}));export{H as f,Js as i};
